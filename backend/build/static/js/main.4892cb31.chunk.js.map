{"version":3,"sources":["reducers/user.js","reducers/index.js","config.js","actions/index.js","components/Navbar.js","hooks/api.js","hooks/login.js","components/Auth/Login.js","components/Auth/AutoLogin.js","components/Auth/Register.js","hooks/register.js","components/Pages/Welcome.js","components/Pages/Content/CreateEventModal.js","images/ntu_map2.jpg","components/Pages/Content/Region.js","components/Pages/Content/Create.js","components/Pages/Content/FindMap.js","components/Pages/Content/Like.js","components/Pages/Content/FindMenu.js","components/Pages/Content/FindMine.js","components/Pages/Content/Find.js","components/Pages/Content/Account.js","components/Pages/Content/About.js","components/Pages/Content/MainPageContent.js","components/Pages/MainPage.js","components/App.js","index.js","localState.js"],"names":["user","state","action","type","token","name","email","id","group","combineReducers","BACKEND","localStateName","login","mapDispatchToProps","logout","connect","hasLoggedin","undefined","userGroup","console","log","useState","style","background","Menu","secondary","Item","as","Link","to","Header","Icon","Content","Subheader","position","Button","animated","color","basic","onClick","visible","hidden","Group","initialState","status","NaN","response","errMsg","loading","success","error","isInit","this","reducer","Error","responseType","onSuccess","onError","useReducer","conn","dispatch","url","method","body","headers","a","fetch","mode","then","res","text","thenable","json","data","catch","err","useAPI","connection","password","JSON","stringify","pwd","hasLoggedIn","useLogin","loginAPI","setEmail","setPassword","redirect","setRedirect","useEffect","setTimeout","Grid","textAlign","width","marginTop","Column","maxWidth","icon","Message","negative","positive","Form","onSubmit","e","preventDefault","Input","iconPosition","placeholder","required","onChange","target","value","Loader","active","inline","Register","useSelector","useRegister","registerAPI","setName","Field","divStyle","display","flexDirection","alignItems","Welcome","size","regionColor","CreateEventModal","region","createState","create","setError","setErrMsg","location","setLocation","date","setDate","beginTime","setBeginTime","endTime","setEndTime","amountText","setAmountText","description","setDescription","admin","Modal","paddingLeft","Segment","isNaN","amount","Math","round","parseInt","begin","Date","parse","end","length","widths","label","textDecoration","marginBottom","TextArea","regionRGBary","regionName","Region","x","y","idx","select","left","top","backgroundColor","regionStyle","setRegionStyle","onMouseEnter","onMouseLeave","className","regionAry","mapW","Create","selection","setSelection","open","setOpen","useMeasure","ref","height","boundStyle","right","bottom","bounds","src","ntuMap","alt","map","dimmer","onClose","onOpen","Actions","FindMap","Like","totalLikes","likeState","evtId","likeConn","likeConnection","nowLikeState","setNowLikeState","nowTotalLikes","setNowTotalLikes","handleLikeState","newLikeState","padding","borderBottom","inverted","FindMenu","reconn","reconnect","events","setEvents","_id","newEvents","evt","Image","Card","filter","floated","_source","Meta","Description","extra","FindMine","myEvents","setMyEvents","revisedAmount","setRevisedAmount","openRevise","setOpenRevise","openConfirm","setOpenConfirm","revisingEvent","setRevisingEvent","refresh","delete","revise","startRevise","startDelete","Confirm","onCancel","onConfirm","content","primary","alert","newAmount","Find","pointing","Account","About","MainPageContent","MainPage","contextRef","useRef","activeItem","setActiveItem","paddingTop","paddingRight","columns","divided","Row","zIndex","Sticky","context","fluid","vertical","tabular","Divider","stretched","Navbar","exact","path","query","URLSearchParams","search","get","match","params","unknown","persistedState","serializedState","localStorage","getItem","expirationTime","now","removeItem","loadState","store","createStore","rootReducer","subscribe","throttle","setItem","bestBefore","toString","saveState","getState","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.4892cb31.chunk.js","sourcesContent":["const user = (state = {}, action) => {\r\n  switch(action.type) {\r\n    case 'LOGIN':\r\n      return {\r\n        token: action.token,\r\n        name: action.name,\r\n        email: action.email,\r\n        id: action.id,\r\n        group: action.group\r\n      };\r\n    case 'LOGOUT':\r\n      return {};\r\n    default:\r\n      return state;\r\n  };\r\n};\r\n\r\nexport default user;","import { combineReducers } from 'redux';\r\nimport user from './user';\r\n\r\nexport default combineReducers({\r\n  user\r\n});","export const BACKEND=\"http://localhost/\"\r\n// export const BACKEND=\"https://tanet30-back.tp1rc.edu.tw\";\r\nexport const loginURL=\"http://localhost:3000/login\";\r\n// export const loginURL=\"https://tanet30.tp1rc.edu.tw/login\";\r\nexport const FRONTEND=\"http://localhost:3000\"\r\n// export const FRONTEND=\"https://tanet30.tp1rc.edu.tw\";\r\nexport const localStateName = \"NTU-MEAL\";","export const login = (token, name, group, email, id) => ({\r\n  type: 'LOGIN',\r\n  token,\r\n  name,\r\n  group,\r\n  email,\r\n  id,\r\n});\r\n\r\nexport const logout = () => ({type: \"LOGOUT\"});","import React, { useState } from 'react';\r\nimport { Header, Menu, Image, Button, Sidebar, Icon } from 'semantic-ui-react';\r\nimport { Link } from 'react-router-dom';\r\nimport { connect } from 'react-redux';\r\nimport { logout } from '../actions';\r\n\r\nconst mapStateToProps = (state) => ({\r\n  hasLoggedin: state.user.token !== undefined,\r\n  id: state.user.id,\r\n  name: state.user.name,\r\n  userGroup: state.user.group\r\n})\r\n\r\nconst mapDispatchToProps = { logout };\r\n\r\nconst NavBar = ({ hasLoggedin, name, userGroup, logout }) => {\r\n  console.log(hasLoggedin);\r\n\r\n  const [visible, setVisible] = useState(false);\r\n  const hide = () => setVisible(false);\r\n  return <div style={{background: \"orange\"}}>\r\n    <Menu secondary >\r\n      <Menu.Item\r\n        as={Link} to=\"/\"\r\n      >\r\n        <Header as='h2'>\r\n          <Icon name='food' />\r\n          <Header.Content>\r\n            NTU - MEAL\r\n            <Header.Subheader>Get meal, reduce waste!</Header.Subheader>\r\n          </Header.Content>\r\n        </Header>\r\n      </Menu.Item>\r\n      <Menu.Menu position='right'>\r\n      {\r\n        hasLoggedin\r\n        ?\r\n        <Menu.Item>\r\n          <Button animated color='grey' basic onClick={() => logout()} >\r\n            <Button.Content visible>Logout</Button.Content>\r\n            <Button.Content hidden>\r\n              <Icon name='sign-out alternate' />\r\n            </Button.Content>\r\n          </Button>\r\n        </Menu.Item>\r\n        :\r\n        <>\r\n          <Menu.Item >\r\n          <Button.Group>\r\n            <Button animated='fade' as={Link} to=\"/login\" color='grey' basic >\r\n              <Button.Content visible>&nbsp;&nbsp;&nbsp;Login&nbsp;&nbsp;&nbsp;</Button.Content>\r\n              <Button.Content hidden>\r\n                <Icon name='sign-in alternate' />\r\n              </Button.Content>\r\n            </Button>\r\n            <Button animated='fade' as={Link} to=\"/register\" color='grey' basic >\r\n              <Button.Content visible>Register</Button.Content>\r\n              <Button.Content hidden>\r\n                <Icon name='add user' />\r\n              </Button.Content>\r\n            </Button>\r\n          </Button.Group>\r\n          </Menu.Item>\r\n        </>\r\n      }\r\n      </Menu.Menu>\r\n    </Menu>\r\n  </div>\r\n  {/* \r\n  const sideBar = (\r\n    <Sidebar\r\n      as={Menu}\r\n      animation='overlay'\r\n      direction=\"right\"\r\n      inverted\r\n      onHide={hide}\r\n      vertical\r\n      visible={visible}\r\n      width='thin'\r\n      icon='labeled'\r\n    >\r\n      <Menu.Item as={Link} onClick={hide} to=\"/home\">\r\n        <Icon name='user' />\r\n        {name}\r\n      </Menu.Item>\r\n      <Menu.Item as={Link} onClick={hide} to=\"/\">\r\n        <Icon name='home' color=\"olive\" />\r\n        Info\r\n      </Menu.Item>\r\n      <Menu.Item as={Link} onClick={hide} to=\"/participatedEvents\">\r\n        <Icon name='list' color=\"teal\" />\r\n        Events\r\n      </Menu.Item>\r\n      <Menu.Item as={Link} onClick={hide} to=\"/tickets\">\r\n        <Icon name='food' color=\"orange\" />\r\n        Food Tickets\r\n      </Menu.Item>\r\n      <Menu.Item as={Link} onClick={hide} to=\"/home\">\r\n        <Icon name='dollar' color=\"yellow\" />\r\n        Transactions\r\n      </Menu.Item>\r\n      <Menu.Item\r\n        name='wallet'\r\n        as={Link} to=\"/receive\"\r\n        onClick={hide}\r\n      >\r\n        <Icon name='qrcode' color=\"grey\" />\r\n        My QRcode\r\n      </Menu.Item>\r\n      <Menu.Item\r\n        onClick={() => {hide(); logout();}}\r\n      >\r\n        <Icon name='sign-out' color=\"grey\" />\r\n        Logout\r\n      </Menu.Item>\r\n    </Sidebar>\r\n  )\r\n\r\n  const mainBar = userGroup === \"user\"\r\n    ?\r\n    <React.Fragment>\r\n      <Responsive className=\"hamburger\" maxWidth={767}>\r\n        <Button icon inverted basic onClick={() => setVisible(true)}>\r\n          <Icon name=\"sidebar\" size=\"big\" />\r\n        </Button>\r\n        {sideBar}\r\n      </Responsive>\r\n      <Responsive minWidth={768}>\r\n        {userDesktopMenu}\r\n      </Responsive>\r\n    </React.Fragment>\r\n    :\r\n    (\r\n      <div className=\"welcome-text\">\r\n        Hello,&nbsp;\r\n        <Link className=\"welcome-link\" to={'/home'}>{name}</Link>\r\n        &nbsp;!&nbsp;\r\n        <Button basic inverted className=\"small-link\" onClick={_ => logout()} >Logout</Button>\r\n      </div>\r\n    );\r\n\r\n  return (\r\n    <div className=\"navbar\">\r\n      <Image src=\"/logo.png\" as='a' href='/' size='medium' className=\"logo\" />\r\n      {hasLoggedin\r\n        ?\r\n        mainBar\r\n        :\r\n        <React.Fragment>\r\n          <Link class=\"link\" to=\"/login\" >Login</Link>\r\n          <Link class=\"link\" to=\"/register\" >Register</Link>\r\n        </React.Fragment>\r\n      }\r\n    </div>\r\n  ); */}\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(NavBar);","import { useReducer } from 'react';\r\n\r\nconst initialState = ({\r\n  status: NaN,\r\n  response: null,\r\n  errMsg: null,\r\n  loading: false,\r\n  success: false,\r\n  error: false,\r\n  isInit: function() {\r\n    return !this.loading && !this.success && !this.error;\r\n  }\r\n})\r\n\r\nconst reducer = (state, action) => {\r\n  switch(action.type) {\r\n    case 'CONNECT':\r\n      return {...state, loading: true};\r\n    case 'SUCCESS':\r\n      return ({\r\n        ...state,\r\n        status: action.status || 200,\r\n        response: action.response,\r\n        errMsg: null,\r\n        loading: false,\r\n        success: true,\r\n        error: false\r\n      });\r\n    case 'ERROR':\r\n      return ({\r\n        ...state,\r\n        status: action.status || 400,\r\n        response: null,\r\n        errMsg: action.errMsg || \"\",\r\n        loading: false,\r\n        success: false,\r\n        error: true\r\n      });\r\n    case 'INIT':\r\n      return initialState;\r\n    default:\r\n      throw new Error(\"Invalid Action Type\");\r\n  }\r\n}\r\n\r\nexport default (responseType, onSuccess, onError) => {\r\n  const [conn, dispatch] = useReducer(reducer, initialState);\r\n  const init = () => dispatch({type: 'INIT'});\r\n\r\n  const connect = async (url, method, body, headers) => {\r\n    dispatch({type: \"CONNECT\"});\r\n    fetch(url, { mode: 'no-cors', method, body, headers })\r\n    .then(res => {\r\n      if(res.status !== 200){\r\n        res.text()\r\n        .then(errMsg => {\r\n          dispatch({\r\n            type: \"ERROR\",\r\n            status: res.status,\r\n            errMsg\r\n          })\r\n          if(onError) onError(errMsg, conn);\r\n        })\r\n      }\r\n      else {\r\n        let thenable = null;\r\n        switch(responseType) {\r\n          case 'json':\r\n            thenable = res.json()\r\n            break;\r\n          case 'text':\r\n            thenable = res.text()\r\n            break;\r\n          default:\r\n            if(onSuccess) onSuccess();\r\n            return dispatch({type: \"SUCCESS\"});\r\n        }\r\n        if(thenable === null) return;\r\n        thenable.then(data => {\r\n          dispatch({\r\n            type: \"SUCCESS\",\r\n            response: data\r\n          })\r\n          if(onSuccess) onSuccess();\r\n        })\r\n        .catch((err) => {\r\n          console.error(err);\r\n          dispatch({\r\n            type: \"ERROR\",\r\n            errMsg: \"Response type Error\"\r\n          })\r\n          if(onError) onError(\"Response type Error\", conn);\r\n        })\r\n      }\r\n    })\r\n    .catch(err => {\r\n      console.error(err);\r\n      dispatch({\r\n        type: \"ERROR\",\r\n        errMsg: \"Connection Error\"\r\n      })\r\n      if(onError) onError(\"Connection Error\", conn);\r\n    })\r\n  }\r\n\r\n  return [conn, connect, init];\r\n}","import useAPI from './api';\r\nimport { BACKEND } from '../config';\r\n\r\nexport default () => {\r\n  const [connection, connect] = useAPI(\"json\");\r\n\r\n  const login = (email, password) => {\r\n    connect(BACKEND+\"/auth/login\", \"POST\", JSON.stringify({email, pwd: password}), {'content-type': \"application/json\"});\r\n  }\r\n\r\n  return [{...connection, ...connection.response}, login];\r\n}","import React, { useState, useEffect } from 'react';\r\nimport { Grid, Form, Button, Message, Icon, Header, Divider } from 'semantic-ui-react';\r\nimport { Redirect } from 'react-router-dom';\r\nimport { connect } from 'react-redux';\r\nimport { login } from '../../actions';\r\nimport { useLogin } from '../../hooks';\r\n\r\nconst mapStateToProps = (state) => ({\r\n  hasLoggedIn: state.user.token !== undefined\r\n})\r\nconst mapDispatchToProps = { login };\r\nconst timeout = 1000;\r\n\r\nconst Login = ({hasLoggedIn, login}) => {\r\n  const [connection, loginAPI] = useLogin();\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [redirect, setRedirect] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if(connection.success && !redirect) {\r\n      login(connection.token, connection.name, connection.group, connection.email, connection.id);\r\n      setTimeout(() => {\r\n        setRedirect(true);\r\n      }, timeout)\r\n    }\r\n  }, [connection, redirect, login])\r\n\r\n  // const onLoad = (data) => {\r\n  //   if(data === null) return;\r\n  //   const [emailIdx, pwIdx] = [data.indexOf(\"email\"), data.indexOf(\"password\")];\r\n  //   if(emailIdx === -1 || pwIdx === -1) {\r\n  //     setQRError(true);\r\n  //     return;\r\n  //   }\r\n  //   const [email, pw] = [\r\n  //     data.substring(emailIdx+6, data.indexOf(\"&\")), \r\n  //     data.substring(pwIdx+9, data.indexOf(\"#\"))\r\n  //   ]\r\n  //   loginAPI(email, pw);\r\n  //   setQRError(false);\r\n  // }\r\n\r\n  // const onError = () => {\r\n  //   setQRError(true);\r\n  // }\r\n\r\n  if((connection.isInit() && hasLoggedIn) || redirect) return <Redirect to=\"/\" />;\r\n\r\n  return (\r\n    <Grid textAlign=\"center\" style={{ width: \"100%\", marginTop: \"2vh\"}}>\r\n      <Grid.Column style={{ width: \"80%\", maxWidth: \"30em\" }}>\r\n        <Header as='h2' icon textAlign='center' color='blue'>\r\n          <Icon name='user circle' />\r\n          <Header.Content>Login</Header.Content>\r\n        </Header>\r\n        {connection.error\r\n          ?\r\n          <Message negative>{connection.errMsg}</Message>\r\n          :\r\n          null\r\n        }\r\n        {connection.success\r\n          ?\r\n          <Message positive>Login Success!</Message>\r\n          :\r\n          null\r\n        }\r\n        <Form\r\n          onSubmit={e => {\r\n            e.preventDefault();\r\n            loginAPI(email, password);\r\n          }}\r\n        >\r\n          <Form.Input icon='user' iconPosition='left' type=\"email\" placeholder=\"Your email\" required= {true} id=\"userEmail\" onChange={e => {setEmail(e.target.value)}} />\r\n          <Form.Input icon='lock' iconPosition='left' type=\"password\" placeholder=\"Your password\"   required={true} id=\"userPassword\" onChange={e => {setPassword(e.target.value)}} />\r\n          <Button color=\"green\" type='submit'>Login</Button>\r\n        </Form>\r\n      </Grid.Column>\r\n    </Grid>\r\n  )\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Login);","import React from 'react';\r\nimport { Grid, Message, Icon, Header, Loader } from 'semantic-ui-react';\r\nimport { Redirect } from 'react-router-dom';\r\nimport { connect } from 'react-redux';\r\nimport { login } from '../../actions';\r\nimport { useLogin } from '../../hooks';\r\n\r\nconst mapStateToProps = () => ({})\r\nconst mapDispatchToProps = { login };\r\n\r\nconst AutoLogin = ({email, password, login}) => {\r\n  const [connection, loginAPI] = useLogin();\r\n\r\n  if(connection.success) {\r\n    login(connection.token, connection.name, connection.email, connection.id, connection.group);\r\n    return <Redirect to=\"/home\" />;\r\n  }\r\n  if(connection.isInit()) {\r\n    loginAPI(email, password);\r\n  }\r\n\r\n  return (\r\n    <Grid textAlign=\"center\" style={{ width: \"100%\", marginTop: \"2vh\"}}>\r\n      <Grid.Column style={{ width: \"80%\", maxWidth: \"30em\" }}>\r\n        <Header as='h2' icon textAlign='center'>\r\n          <Icon name='user circle' />\r\n          <Header.Content>Login With QR-Code</Header.Content>\r\n        </Header>\r\n        {connection.error\r\n          ?\r\n          <Message negative>{connection.errMsg}</Message>\r\n          :\r\n          null\r\n        }\r\n        {connection.loading\r\n          ?\r\n          <Loader active inline='centered' />\r\n          :\r\n          null\r\n        }\r\n        </Grid.Column>\r\n    </Grid>\r\n  )\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(AutoLogin);","import React, { useState, useEffect } from 'react';\r\nimport { Redirect } from 'react-router-dom';\r\nimport { Form, Button, Message, Grid, Header, Icon } from 'semantic-ui-react';\r\nimport { useRegister } from '../../hooks';\r\n\r\nconst timeout = 1000;\r\nconst Register = () => {\r\n  const [connection, registerAPI] = useRegister();\r\n  const [name, setName] = useState(\"\");\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [redirect, setRedirect] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if(connection.success && !redirect) {\r\n      setTimeout(() => {\r\n        setRedirect(true);\r\n      }, timeout)\r\n    }\r\n  }, [connection])\r\n\r\n  if(redirect) return <Redirect to='/login' />\r\n\r\n  return (\r\n    <Grid textAlign=\"center\" style={{ width: \"100%\", marginTop: \"2vh\"}}>\r\n      <Grid.Column style={{ width: \"80%\", maxWidth: \"30em\" }}>\r\n        <Header as='h2' icon textAlign='center' color='red'>\r\n          <Icon name='user circle' />\r\n          <Header.Content>Register</Header.Content>\r\n        </Header>\r\n        <Form\r\n          onSubmit={e => {\r\n            e.preventDefault();\r\n            registerAPI(name, email, password);\r\n          }}\r\n        >\r\n          <Form.Field>\r\n            <Form.Input icon='user' iconPosition='left' placeholder=\"Name\" type=\"text\" required={true} id=\"userName\" onChange={e => { setName(e.target.value); }} />\r\n          </Form.Field>\r\n          <Form.Field>\r\n            <Form.Input icon='mail' iconPosition='left' placeholder=\"Email\" type=\"email\" required={true} id=\"userEmail\" onChange={e => { setEmail(e.target.value); }} />\r\n          </Form.Field>\r\n          <Form.Field>\r\n            <Form.Input icon='lock' iconPosition='left' placeholder=\"Password\" type=\"password\" required={true} id=\"userPassword\" onChange={e => { setPassword(e.target.value); }} />\r\n          </Form.Field>\r\n          <Button color=\"green\" type=\"submit\">\r\n            Register\r\n          </Button>\r\n          {connection.error\r\n            ?\r\n            <Message negative>{connection.errMsg}</Message>\r\n            :\r\n            null\r\n          }\r\n          {connection.success\r\n            ?\r\n            <Message positive>Register Success!</Message>\r\n            :\r\n            null\r\n          }\r\n        </Form>\r\n      </Grid.Column>\r\n    </Grid>\r\n  );\r\n}\r\n\r\nexport default Register;","import useAPI from './api';\r\nimport { useSelector } from 'react-redux';\r\nimport { BACKEND } from '../config'\r\n\r\nexport default () => {\r\n  const [connection, connect] = useAPI();\r\n  const {token} = useSelector(state => state.user);\r\n\r\n  const register = (name, email, password, group='user') => {\r\n    connect(\r\n      BACKEND+\"/auth/register\", \r\n      \"POST\", \r\n      JSON.stringify({name, email, pwd: password, group}), \r\n      {'authorization': token, 'content-type': \"application/json\"}\r\n    );\r\n  }\r\n\r\n  return [connection, register];\r\n}","import React from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { Icon, Header } from 'semantic-ui-react';\r\n\r\nconst divStyle = {\r\n  marginTop: \"2em\",\r\n  width: \"100%\",\r\n  display: \"flex\",\r\n  flexDirection: \"column\",\r\n  alignItems: \"center\"\r\n}\r\n\r\nconst Welcome = () => {\r\n  return (\r\n    <div style={divStyle}>\r\n      <Icon name=\"warning sign\" size=\"huge\" />\r\n      <Header as='h2'>\r\n        Please&nbsp;\r\n        <Link to=\"login\">login</Link>\r\n        &nbsp;or&nbsp;\r\n        <Link to=\"register\">create your account</Link>.\r\n      </Header>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Welcome;","import React, { useState, useEffect } from 'react';\r\nimport { Form, Button, Message, Modal, Segment, Header, Icon } from 'semantic-ui-react';\r\nimport { useSelector } from 'react-redux'\r\nimport { useAPI } from '../../../hooks';\r\nimport { BACKEND } from '../../../config';\r\n\r\nconst regionColor = {\r\n  \"E\": 'red',\r\n  \"N\": 'blue',\r\n  \"M\": 'green', \r\n  \"S\": 'brown',\r\n  \"SE\": 'purple',\r\n  \"W\": 'orange',\r\n  \"CZ\": \"teal\"\r\n};\r\n\r\nconst CreateEventModal = ({ region }) => {\r\n  const [createState, create] = useAPI(\"text\");\r\n  const [error, setError] = useState(false);\r\n  const [errMsg, setErrMsg] = useState(\"\");\r\n  const [name, setName] = useState(\"\");\r\n  const [location, setLocation] = useState(\"\");\r\n  const [date, setDate] = useState(\"\");\r\n  const [beginTime, setBeginTime] = useState(\"\");\r\n  const [endTime, setEndTime] = useState(\"\");\r\n  const [amountText, setAmountText] = useState(\"\")\r\n  const [description, setDescription] = useState(\"\");\r\n  const { token, id: admin } = useSelector(state => state.user);\r\n\r\n  useEffect(() => {\r\n    if(error) {\r\n      setTimeout(() => {\r\n        setError(false);\r\n        setErrMsg(\"\");\r\n      }, 3000);\r\n    }\r\n  }, [error])\r\n\r\n  const onSubmit = (e) => {\r\n    e.preventDefault();\r\n    \r\n    if(isNaN(amountText)) {\r\n      setError(true);\r\n      setErrMsg(\"Input Amount is not a number !\");\r\n      return;\r\n    }\r\n    const amount = Math.round(parseInt(amountText));\r\n    if(amount < 0) {\r\n      setError(true);\r\n      setErrMsg(\"Input Amount must > 0 !\");\r\n      return;\r\n    }\r\n\r\n    const begin =  Date.parse(date + \" \" + beginTime);\r\n    const end =  Date.parse(date + \" \" + endTime);\r\n    if(end <= begin) {\r\n      setError(true);\r\n      setErrMsg(\"End time should be later than begin time!\");\r\n      return;\r\n    }\r\n    \r\n    if(description.length > 100) {\r\n      setError(true);\r\n      setErrMsg(\"Description too long (must < 100 words) !\");\r\n      return;\r\n    }\r\n    const body = { admin, region, name, location, date, begin, end, amount, description };\r\n    console.log(body);\r\n    create(\r\n      BACKEND+\"/event\",\r\n      \"POST\", \r\n      JSON.stringify(body), \r\n      {'authorization': token, 'content-type': \"application/json\"}\r\n    )\r\n  }\r\n\r\n  return <>\r\n    <Modal.Header>\r\n      <Header as='h2' color={regionColor[region]} style={{paddingLeft: \"5px\"}}>\r\n        {`Create Event at region ${region}`}\r\n      </Header>\r\n    </Modal.Header>\r\n    <Modal.Content>\r\n    <Segment textAlign='center' color={regionColor[region]}>\r\n    <div style={{display: \"flex\", flexDirection: \"column\", alignItems: \"center\"}}>\r\n      <Form onSubmit={e => onSubmit(e)} loading={createState.loading}>\r\n        <Form.Group widths=\"equal\">\r\n          <Form.Input type=\"text\" label=\"Event name\" required={true} placeholder=\"e.g. 研討會剩餘便當\" id=\"name\" onChange={e => { setName(e.target.value); }} />        \r\n          <Form.Input type=\"text\" label=\"Location\" required={true} placeholder=\"e.g. 博理館 113\" id=\"location\" onChange={e => { setLocation(e.target.value); }} />        \r\n        </Form.Group>\r\n        {/* <Form.Field required>\r\n        </Form.Field> */}\r\n        <Form.Field required>\r\n          <label>Date</label>\r\n          <Form.Group widths=\"equal\">\r\n            <Form.Input type=\"date\" required={true} id=\"date\" onChange={e => { setDate(e.target.value); }} />\r\n          </Form.Group>\r\n          <label style={{ textDecoration: \"none\", marginBottom: \"1em\" }}>Time interval</label>\r\n          <Form.Group widths=\"equal\">\r\n            <Form.Input type=\"time\" required={true} id=\"timeBegin\" onChange={e => { setBeginTime(e.target.value); }} />\r\n            <Form.Input type=\"time\" required={true} id=\"timeEnd\" onChange={e => { setEndTime(e.target.value) }} />\r\n          </Form.Group>\r\n        </Form.Field>\r\n        <Form.Field>\r\n          <Form.Group widths=\"equal\">\r\n            <Form.Input type=\"text\" label='Amount' required={true} id=\"amount\" onChange={e => { setAmountText(e.target.value); }} />\r\n          </Form.Group>\r\n        </Form.Field>\r\n        <Form.Field>\r\n          <label>More details...</label>\r\n          <Form.TextArea required={false} placeholder='More details or descriptions...( < 100 words)'  onChange={ e => { setDescription(e.target.value); }} />\r\n        </Form.Field>\r\n        {createState.error || error\r\n          ?\r\n          <Message negative>{error?errMsg:createState.errMsg}</Message>\r\n          :\r\n          null\r\n        }\r\n        {createState.success\r\n          ?\r\n          <Message positive>Create Event Success!</Message>\r\n          :\r\n          null\r\n        }\r\n        <Button animated='fade' color={regionColor[region]} basic type=\"submit\" >\r\n          <Button.Content visible>Create Event</Button.Content>\r\n          <Button.Content hidden>\r\n            <Icon name='add' />\r\n            <Icon name='wordpress forms' />\r\n          </Button.Content>\r\n        </Button>\r\n        {/* <Button color={regionColor[region]} basic type=\"submit\" >\r\n          Create\r\n        </Button> */}\r\n      </Form>\r\n      </div>\r\n    </Segment>\r\n    </Modal.Content>\r\n  </>;\r\n}\r\n\r\nexport default CreateEventModal;\r\n","export default __webpack_public_path__ + \"static/media/ntu_map2.fde23396.jpg\";","import React, { useState } from 'react';\r\nimport '../styles/Region.css';\r\n\r\nconst regionRGBary = [[205, 92, 92], [135, 206, 250], [50, 205, 50], [218, 165, 32], [138, 43, 226 ], [255, 140, 0], [32, 178, 170]]\r\nconst regionName = [\"E\", \"N\", \"M\", \"S\", \"SE\", \"W\", \"CZ\"];\r\n\r\nconst Region = ({x, y, idx, select}) => {\r\n  const [regionStyle, setRegionStyle] = useState({\r\n    left: `${x}px`,\r\n    top: `${y}px`,\r\n    backgroundColor: `rgba(${regionRGBary[idx][0]}, ${regionRGBary[idx][1]}, ${regionRGBary[idx][2]}, 0.5)`\r\n  });\r\n\r\n  const onHover = () => {\r\n    setRegionStyle({\r\n      left: `${x}px`,\r\n      top: `${y}px`,\r\n      backgroundColor: `rgba(${regionRGBary[idx][0]}, ${regionRGBary[idx][1]}, ${regionRGBary[idx][2]}, 0.2)`\r\n    })\r\n  }\r\n\r\n  const unHover = () => {\r\n    setRegionStyle({\r\n      left: `${x}px`,\r\n      top: `${y}px`,\r\n      backgroundColor: `rgba(${regionRGBary[idx][0]}, ${regionRGBary[idx][1]}, ${regionRGBary[idx][2]}, 0.5)`\r\n    })\r\n  }\r\n\r\n  return <div onMouseEnter={()=>onHover()} onMouseLeave={()=>unHover()} className='circle_div' style={regionStyle} onClick={() => select(regionName[idx])}>\r\n    \r\n  </div>\r\n}\r\n\r\nexport default Region;","import React, { useState } from 'react';\r\nimport { useMeasure } from 'react-use';\r\nimport \"../styles/Create.css\";\r\nimport { Modal, Button, Icon } from 'semantic-ui-react';\r\nimport CreateEventModal from './CreateEventModal';\r\nimport ntuMap from '../../../images/ntu_map2.jpg';\r\nimport Draggable from 'react-draggable';\r\nimport Region from './Region';\r\n\r\nconst regionAry = [[854, 277], [571, 269], [490, 398], [702.5, 507.5], [933.5, 517], [220, 531], [219, 117]];\r\nconst mapW = 1200;\r\nconst mapH = mapW * 3543 / 4961;\r\n\r\nconst regionColor = {\r\n  \"E\": 'red',\r\n  \"N\": 'blue',\r\n  \"M\": 'green', \r\n  \"S\": 'brown',\r\n  \"SE\": 'purple',\r\n  \"W\": 'orange',\r\n  \"CZ\": \"teal\"\r\n};\r\n\r\nconst Create = () => {\r\n  const [ selection, setSelection ] = useState(\"\");\r\n  const [ open, setOpen ] = useState(false);\r\n  const [ ref, { width, height } ] = useMeasure();\r\n\r\n  const select = (name) => {\r\n    setOpen(true);\r\n    setSelection(name);\r\n  }\r\n\r\n  const boundStyle = {left: -(mapW - width)/2, right: (mapW - width)/2, top: -(mapH - height), bottom: 0 };\r\n\r\n  return <>\r\n    <div className='flex_div container' ref={ref} >\r\n      <Draggable bounds={boundStyle}>\r\n        <div className='inline_div'>\r\n          <img src={ntuMap} alt=\"use this map to select event region\" className=\"background_img\"/>\r\n          {\r\n            regionAry.map((location, idx) => {\r\n              return <Region key={idx} idx={idx} x={location[0]} y={location[1]} select={select} />\r\n            })\r\n          }\r\n        </div>\r\n      </Draggable>\r\n    </div>\r\n    <Modal \r\n      color={regionColor[selection]}\r\n      dimmer='inverted'\r\n      onClose={() => setOpen(false)}\r\n      onOpen={() => setOpen(true)}\r\n      open={open}\r\n    >\r\n      <CreateEventModal region={selection} />\r\n      <Modal.Actions>\r\n        <Button onClick={() => setOpen(false)} color='red'>\r\n          <Icon name='close' /> close\r\n        </Button>\r\n      </Modal.Actions>\r\n    </Modal>\r\n  </>\r\n}\r\n\r\nexport default Create;","import React from 'react';\r\nimport { useMeasure } from 'react-use';\r\nimport \"../styles/Create.css\";\r\nimport ntuMap from '../../../images/ntu_map2.jpg';\r\nimport Draggable from 'react-draggable';\r\nimport Region from './Region';\r\n\r\nconst regionAry = [[854, 277], [571, 269], [490, 398], [702.5, 507.5], [933.5, 517], [220, 531], [219, 117]];\r\nconst mapW = 1200;\r\nconst mapH = mapW * 3543 / 4961;\r\n\r\nconst FindMap = ({select}) => {\r\n  const [ ref, { width, height } ] = useMeasure();\r\n\r\n  const boundStyle = {left: -(mapW - width)/2, right: (mapW - width)/2, top: -(mapH - height), bottom: 0 };\r\n\r\n  return <>\r\n    <div className='flex_div container' ref={ref} >\r\n      <Draggable bounds={boundStyle}>\r\n        <div className='inline_div'>\r\n          <img src={ntuMap} alt=\"use this map to select event region\" className=\"background_img\"/>\r\n          {\r\n            regionAry.map((location, idx) => {\r\n              return <Region key={idx} idx={idx} x={location[0]} y={location[1]} select={select} />\r\n            })\r\n          }\r\n        </div>\r\n      </Draggable>\r\n    </div>\r\n  </>\r\n}\r\n\r\nexport default FindMap;","import React, { useState, useEffect } from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport { Button, Icon } from 'semantic-ui-react';\r\nimport { useAPI } from '../../../hooks';\r\nimport { BACKEND } from '../../../config';\r\n\r\nconst Like = ({ totalLikes = -100, likeState = -100, evtId }) => {\r\n  const { token } = useSelector(state => state.user);\r\n  const [likeConn, likeConnection] = useAPI('json');\r\n  const [nowLikeState, setNowLikeState] = useState(likeState);\r\n  const [nowTotalLikes, setNowTotalLikes] = useState(totalLikes);\r\n\r\n  const handleLikeState = (newLikeState) => {\r\n    if(newLikeState === nowLikeState) {\r\n      setNowTotalLikes(totalLikes - likeState);\r\n      setNowLikeState(0);\r\n      const body = { likeState: 0, evtId: evtId };\r\n      likeConnection(\r\n        BACKEND + `/event/like`,\r\n        \"POST\",\r\n        JSON.stringify(body),\r\n        { 'authorization': token, 'content-type': \"application/json\" }\r\n      )\r\n    }\r\n    else {\r\n      setNowTotalLikes(totalLikes - likeState + newLikeState);\r\n      setNowLikeState(newLikeState);\r\n      const body = { likeState: newLikeState, evtId: evtId };\r\n      likeConnection(\r\n        BACKEND + `/event/like`,\r\n        \"POST\",\r\n        JSON.stringify(body),\r\n        { 'authorization': token, 'content-type': \"application/json\" }\r\n      )\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    console.log(likeConn);\r\n  }, [likeConn])\r\n\r\n  return <>\r\n    <Icon name='thumbs up outline' size='tiny' style={{padding: \"10px\", borderBottom: \"10px\"}} />{nowTotalLikes}\r\n    <div className='ui two buttons'>\r\n      <Button basic={nowLikeState !== 1} inverted={nowLikeState === 1} active={true} color='green' onClick={() => handleLikeState(1)}>\r\n        Approve\r\n      </Button>\r\n      <Button basic={nowLikeState !== -1} inverted={nowLikeState === -1} active={true} color='red'  onClick={() => handleLikeState(-1)}>\r\n        Decline\r\n      </Button>\r\n    </div>\r\n  </>\r\n}\r\n\r\nexport default Like;","import React, { useState, useEffect } from 'react';\r\nimport { Icon, Message, Segment, Image, Button, Card } from 'semantic-ui-react';\r\nimport { useSelector } from 'react-redux';\r\nimport { useAPI } from '../../../hooks';\r\nimport { BACKEND } from '../../../config';\r\nimport Like from './Like';\r\n\r\nconst regionColor = {\r\n  \"MAP\":'grey',\r\n  \"ALL\": 'black',\r\n  \"E\": 'red',\r\n  \"N\": 'blue',\r\n  \"M\": 'green', \r\n  \"S\": 'brown',\r\n  \"SE\": 'purple',\r\n  \"W\": 'orange',\r\n  \"CZ\": \"teal\"\r\n};\r\n\r\nconst FindMenu = ({ region, connection }) => {\r\n  const { loading, success, error, errMsg, response } = connection;\r\n  const { token } = useSelector(state => state.user);\r\n  const [ reconn, reconnect ] = useAPI('json');\r\n  const [events, setEvents] = useState(response);\r\n\r\n  const refresh = (evtId, _source) => {\r\n    console.log(_source);\r\n    reconnect(\r\n      BACKEND + `/event/single?id=${evtId}`,\r\n      \"GET\",\r\n      null,\r\n      { 'authorization': token, 'content-type': \"application/json\" }\r\n    )\r\n  }\r\n\r\n  useEffect(() => {\r\n    if(reconn.success) {\r\n      console.log(reconn);\r\n      const { _id, name, region, location, date, begin, end, amount, description, totalLikes, likeState } = reconn.response;\r\n      const newEvents = events.map((evt, idx) => {\r\n        if(evt._id === _id) {\r\n          return { _id, name, region, location, date, begin, end, amount, description, totalLikes, likeState };\r\n        }\r\n        return evt;\r\n      })\r\n      setEvents(newEvents);\r\n      console.log(newEvents);\r\n    }\r\n  }, [reconn])\r\n\r\n  return <>\r\n    {\r\n      loading?\r\n      <Segment loading>\r\n        <Image src='https://react.semantic-ui.com/images/wireframe/paragraph.png' />\r\n      </Segment>\r\n      :\r\n      success?\r\n      <Card.Group>\r\n      {\r\n        events.filter((evt) => evt.region === region || region === \"ALL\").map((evt, idx) => {\r\n          return (\r\n              <Card key={`${region}-${idx}`} color={regionColor[region]}>\r\n                <Card.Content>\r\n                  <Button icon floated='right' basic color={regionColor[region]} onClick={() => refresh(evt._id, `${region}-${idx}`)}>\r\n                    <Icon name='refresh' />\r\n                  </Button>\r\n                  <Card.Header>{evt.name}</Card.Header>\r\n                  <Card.Meta>{evt.location}</Card.Meta>\r\n                  <Card.Description>\r\n                    <strong>date: </strong>{evt.date}\r\n                    <br/>\r\n                    <strong>amount: </strong>{evt.amount}\r\n                    <br/>\r\n                    <strong>description: </strong>{evt.description}\r\n                  </Card.Description>\r\n                </Card.Content>\r\n                <Card.Content extra>\r\n                  <Like  totalLikes={evt.totalLikes} likeState={evt.likeState} evtId={evt._id} />\r\n                  {/* <Icon name='thumbs up outline' size='tiny' style={{padding: \"10px\", borderBottom: \"10px\"}} />{10}\r\n                  <div className='ui two buttons'>\r\n                    <Button basic color='green'>\r\n                      Approve\r\n                    </Button>\r\n                    <Button basic color='red'>\r\n                      Decline\r\n                    </Button>\r\n                  </div> */}\r\n                </Card.Content>\r\n              </Card>\r\n          );\r\n        })\r\n      }\r\n      </Card.Group>\r\n      :\r\n      error?\r\n      <Message negative>{errMsg}</Message>\r\n      :\r\n      null\r\n    }\r\n  </>\r\n}\r\n\r\nexport default FindMenu;","import React, { useState, useEffect } from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport { Icon, Message, Segment, Image, Button, Card, Input, Confirm, Modal } from 'semantic-ui-react';\r\nimport { useAPI } from '../../../hooks';\r\nimport { BACKEND } from '../../../config';\r\n\r\nconst FindMine = () => {\r\n  const { token } = useSelector(state => state.user);\r\n  const [conn, connect] = useAPI('json');\r\n  const [myEvents, setMyEvents] = useState([]);\r\n  const [revisedAmount, setRevisedAmount] = useState(\"\");\r\n  const [openRevise, setOpenRevise] = useState(false);\r\n  const [openConfirm, setOpenConfirm] = useState(false);\r\n  const [revisingEvent, setRevisingEvent] = useState(null);\r\n\r\n  if (conn.isInit()) {\r\n    connect(\r\n      BACKEND + `/event/mine`,\r\n      \"GET\",\r\n      null,\r\n      { 'authorization': token, 'content-type': \"application/json\" }\r\n    );\r\n  }\r\n\r\n  const revise = () => {\r\n    if(isNaN(revisedAmount) || revisedAmount === \"\") {\r\n      alert('please input a number!');\r\n      return;\r\n    }\r\n    const newAmount = Math.round(parseInt(revisedAmount));\r\n    console.log(revisingEvent);\r\n    console.log(newAmount);\r\n    const body = { amount: newAmount };\r\n    connect(\r\n      BACKEND + `/event/revise?id=${revisingEvent._id}`,\r\n      \"POST\",\r\n      JSON.stringify(body),\r\n      { 'authorization': token, 'content-type': \"application/json\" }\r\n    )\r\n    setRevisingEvent(null);\r\n    setOpenRevise(false);\r\n    setRevisedAmount(\"\");\r\n  }\r\n  \r\n  const deleteEvent = () => {\r\n    connect(\r\n      BACKEND + `/event/delete?id=${revisingEvent._id}`,\r\n      \"POST\",\r\n      null,\r\n      { 'authorization': token, 'content-type': \"application/json\" }\r\n    )\r\n    setRevisingEvent(null);\r\n    setOpenConfirm(false);\r\n  }\r\n\r\n  const startRevise = (evt) => {\r\n    setOpenRevise(true);\r\n    setRevisingEvent(evt);\r\n  }\r\n  \r\n  const startDelete = (evt) => {\r\n    setOpenConfirm(true);\r\n    setRevisingEvent(evt);\r\n  }\r\n\r\n  const refresh = () => {\r\n    console.log(\"refresh\");\r\n    connect(\r\n      BACKEND + `/event/mine`,\r\n      \"GET\",\r\n      null,\r\n      { 'authorization': token, 'content-type': \"application/json\" }\r\n    )\r\n    setRevisingEvent(null);\r\n    setOpenConfirm(false);\r\n    setOpenRevise(false);\r\n    setRevisedAmount(\"\");\r\n  }\r\n  \r\n  useEffect(() => {\r\n    console.log(conn);\r\n    if(conn.success) {\r\n      if(conn.response.delete === true) {\r\n        refresh();\r\n        return;\r\n      }\r\n      if(conn.response.revise === true) {\r\n        refresh();\r\n        return;\r\n      }\r\n      if(typeof(conn.response) === typeof([])){\r\n        console.log(\"conn: \", conn.response);\r\n        setMyEvents([ ...conn.response ]);\r\n      }\r\n    }\r\n  }, [conn.response]);\r\n\r\n  return <>\r\n    {\r\n      conn.loading?\r\n      <Segment loading>\r\n        <Image src='https://react.semantic-ui.com/images/wireframe/paragraph.png' />\r\n      </Segment>\r\n      :\r\n      conn.success?\r\n      <>\r\n      <Card.Group>\r\n      {\r\n        myEvents.map((evt, idx) => {\r\n          return (\r\n            <Card key={`MINE-${idx}`} color='black'>\r\n              <Card.Content>\r\n                <Button icon floated='right' basic color='black' onClick={() => refresh(evt._id, `MINE-${idx}`)}>\r\n                  <Icon name='refresh' />\r\n                </Button>\r\n                <Card.Header>{evt.name}</Card.Header>\r\n                <Card.Meta>{evt.location}</Card.Meta>\r\n                <Card.Description>\r\n                  <strong>date: </strong>{evt.date}\r\n                  <br/>\r\n                  <strong>amount: </strong>{evt.amount}\r\n                  <br/>\r\n                  <strong>description: </strong>{evt.description}\r\n                </Card.Description>\r\n              </Card.Content>\r\n              <Card.Content extra>\r\n                <div className='ui two buttons'>\r\n                  <Button basic color='green' onClick={() => startRevise(evt)} >\r\n                    Revise\r\n                  </Button>\r\n                  <Button basic color='red' onClick={() => startDelete(evt)} >\r\n                    Delete\r\n                  </Button>\r\n                </div>\r\n              </Card.Content>\r\n            </Card>\r\n          );\r\n        })\r\n      }\r\n      </Card.Group>\r\n      </>\r\n      :\r\n      conn.error?\r\n      <Message negative>{conn.errMsg}</Message>\r\n      :\r\n      null\r\n    }\r\n    <Confirm \r\n      open={openConfirm}\r\n      onCancel={() => {setRevisingEvent(null); setOpenConfirm(false)}}\r\n      onConfirm={() => deleteEvent()}\r\n    />\r\n    <Modal\r\n      size='tiny'\r\n      open={openRevise}\r\n      onClose={() => {setOpenRevise(false);setRevisingEvent(null);setRevisedAmount(0)}}\r\n    >\r\n      <Modal.Header>Revise amount</Modal.Header>\r\n      <Modal.Content>\r\n        <Input type='text' placeholder='type in new amount' onChange={(e) => {setRevisedAmount(e.target.value)}} />\r\n      </Modal.Content>\r\n      <Modal.Actions>\r\n        <Button floated='left' content='Confirm revise' primary onClick={() => revise()} />\r\n        <Button onClick={() => {setOpenRevise(false);setRevisedAmount(0);setRevisingEvent(null)}} color='red'>\r\n          <Icon name='close' /> close\r\n        </Button>\r\n      </Modal.Actions>\r\n    </Modal>\r\n  </>\r\n}\r\n\r\nexport default FindMine;","import React, { useState, useEffect } from 'react';\r\nimport { Menu, Segment } from 'semantic-ui-react';\r\nimport { useAPI } from '../../../hooks';\r\nimport { useSelector } from 'react-redux';\r\nimport FindMap from './FindMap';\r\nimport FindMenu from './FindMenu';\r\nimport FindMine from './FindMine';\r\nimport { BACKEND } from '../../../config';\r\n\r\nconst regionAry = [\"ALL\", \"E\", \"N\", \"M\", \"S\", \"SE\", \"W\", \"CZ\"];\r\nconst regionColor = {\r\n  \"MAP\":'grey',\r\n  \"ALL\": 'black',\r\n  \"E\": 'red',\r\n  \"N\": 'blue',\r\n  \"M\": 'green', \r\n  \"S\": 'brown',\r\n  \"SE\": 'purple',\r\n  \"W\": 'orange',\r\n  \"CZ\": \"teal\"\r\n};\r\n\r\nconst Find = () => {\r\n  const { token } = useSelector(state => state.user);\r\n  const [selection, setSelection] = useState(\"MAP\");\r\n  const [connection, connect] = useAPI(\"json\");\r\n  const [events, setEvents] = useState([]);\r\n  if (connection.isInit()) {\r\n    connect(\r\n      BACKEND + `/event/all`,\r\n      \"GET\",\r\n      null,\r\n      { 'authorization': token, 'content-type': \"application/json\" }\r\n    );\r\n  }\r\n  // let events = connection.response || [];\r\n  useEffect(() => {\r\n    console.log(connection);\r\n    if(connection.success) {\r\n      console.log(`Get response: ${connection.response}`);\r\n      setEvents(connection.response || []);\r\n    }\r\n  }, [connection])\r\n\r\n  const select = (name) => {\r\n    setSelection(name);\r\n  }\r\n\r\n  return <>\r\n    <div>\r\n      <Menu pointing secondary>\r\n        <Menu.Item\r\n          name='MAP'\r\n          active={selection === 'MAP'}\r\n          onClick={() => select(\"MAP\")}\r\n        />\r\n        {\r\n          regionAry.map((region, idx) => (\r\n            <Menu.Item\r\n              key={idx}\r\n              name={region}\r\n              color={regionColor[region]}\r\n              active={selection === region}\r\n              onClick={() => select(region)}\r\n            />\r\n          ))\r\n        }\r\n        <Menu.Menu position='right'>\r\n          <Menu.Item\r\n            name='MINE'\r\n            active={selection === 'MINE'}\r\n            onClick={() => select(\"MINE\")}\r\n          />\r\n        </Menu.Menu>\r\n      </Menu>\r\n      {\r\n        selection === 'MAP'?\r\n        <Segment color={regionColor[selection]}>\r\n          <FindMap select={select} />\r\n        </Segment>\r\n        :\r\n        selection === 'MINE'?\r\n        <FindMine />\r\n        :\r\n        <FindMenu region={selection}  connection={connection} />\r\n      }\r\n    </div>\r\n  </>\r\n}\r\n\r\nexport default Find;","import React from 'react';\r\n\r\nconst Account = () => {\r\n  return <>\r\n  </>\r\n}\r\n\r\nexport default Account;","import React from 'react';\r\n\r\nconst About = () => {\r\n  return <>\r\n  </>\r\n}\r\n\r\nexport default About;","import React, { useState, useEffect } from 'react';\r\nimport { useSelector } from 'react-redux';\r\nimport { Find, Create, Account, About } from '../Content';\r\n\r\n\r\nconst MainPageContent = ({selection}) => {\r\n  switch (selection) {\r\n    case \"Find\":\r\n      return <Find />\r\n    case \"Create\":\r\n      return <Create />\r\n    case \"Account\":\r\n      return <Account />\r\n    case \"About\":\r\n      return <About />\r\n    default:\r\n      return <> </>\r\n  }\r\n}\r\n\r\nexport default MainPageContent;","import React, { useState, useRef } from 'react';\r\nimport { Header, Icon, Divider, Image, Segment, Container, Grid, Label, Menu, Sticky } from 'semantic-ui-react';\r\nimport MainPageContent from './Content/MainPageContent';\r\n\r\n\r\nconst MainPage = () => {\r\n  const contextRef = useRef(null);\r\n  const [activeItem, setActiveItem] = useState('Find');\r\n  const select = (name) => {\r\n    console.log(name);\r\n    setActiveItem(name);\r\n  }\r\n  \r\n  // console.log(\"Mainpage: \", token, userId, userName, userEmail);\r\n  return <div style={{paddingTop: \"2vh\", paddingLeft: \"2vh\", paddingRight: \"2vh\"}} ref={contextRef}>\r\n    <Grid columns={4} divided >\r\n    <Grid.Row>\r\n      <Grid.Column width={4} style={{paddingRight: \"0px\", zIndex:'1'}}>\r\n        <Sticky context={contextRef}>\r\n          <Menu fluid vertical tabular>\r\n            <Menu.Item\r\n              name='Find'\r\n              active={activeItem === 'Find'}\r\n              onClick={(e, {name}) => select(name)}\r\n            >\r\n              <Header as='h4' style={{padding: \"1vh\"}}>\r\n                <Icon name='search' />\r\n                <Header.Content>\r\n                  Find\r\n                </Header.Content>\r\n              </Header>\r\n            </Menu.Item>\r\n            <Menu.Item\r\n              name='Create'\r\n              active={activeItem === 'Create'}\r\n              onClick={(e, {name}) => select(name)}\r\n            >\r\n              <Header as='h4' style={{padding: \"1vh\"}}>\r\n                <Icon name='bullhorn' />\r\n                <Header.Content>\r\n                  Create\r\n                </Header.Content>\r\n              </Header>\r\n            </Menu.Item>\r\n            <Menu.Item\r\n              name='Account'\r\n              active={activeItem === 'Account'}\r\n              onClick={(e, {name}) => select(name)}\r\n            >\r\n              <Header as='h4' style={{padding: \"1vh\"}}>\r\n                <Icon name='user circle' />\r\n                <Header.Content>\r\n                  Account\r\n                </Header.Content>\r\n              </Header>\r\n            </Menu.Item>\r\n            <Menu.Item\r\n              name='About'\r\n              active={activeItem === 'About'}\r\n              onClick={(e, {name}) => select(name)}\r\n            >\r\n              <Header as='h4' style={{padding: \"1vh\"}}>\r\n                <Icon name='info circle' />\r\n                <Header.Content>\r\n                  About\r\n                </Header.Content>\r\n              </Header>\r\n            </Menu.Item>\r\n          </Menu>\r\n        </Sticky>\r\n      </Grid.Column>\r\n      <Divider vertical />\r\n      <Grid.Column stretched width={12} >\r\n        <Segment>\r\n          <MainPageContent selection={activeItem} />\r\n        </Segment>\r\n      </Grid.Column>\r\n      </Grid.Row>\r\n    </Grid>\r\n  </div>\r\n}\r\n\r\nexport default MainPage;","import React from 'react';\r\nimport { BrowserRouter, Switch, Route, Redirect } from 'react-router-dom';\r\nimport { connect } from 'react-redux';\r\nimport { Navbar, Login, Register, AutoLogin, Welcome, MainPage } from '../components';\r\n// import { \r\n\r\n// } from '../containers';\r\n\r\nconst mapStateToProps = (state) => ({\r\n  hasLoggedIn: state.user.token !== undefined,\r\n})\r\n\r\nconst mustLogin = (hasLoggedIn, Tag) => {\r\n  if(hasLoggedIn) return Tag;\r\n  else return <Redirect to=\"/\" />;\r\n}\r\n\r\nfunction App({hasLoggedIn}) {\r\n\r\n  return (\r\n    // <div style={{display: \"flex\", flexDirection: \"column\", alignItems: \"center\"}}>\r\n    <div style={{ display: \"flex\", flexDirection: \"column\"}}>\r\n      <BrowserRouter>\r\n        <Navbar />\r\n        <Switch>\r\n          <Route exact path=\"/\">\r\n            {/*hasLoggedIn?\r\n              <MainPage />\r\n              :\r\n              <Welcome />\r\n            */}\r\n            {hasLoggedIn?<MainPage />:<Welcome />}\r\n          </Route>\r\n          <Route exact path=\"/login\">\r\n            {({ location }) => {\r\n              const query = new URLSearchParams(location.search);\r\n              const [email, password] = [query.get(\"email\"), query.get(\"password\")];\r\n              if(email && password) return <AutoLogin email={email} password={password} />;\r\n              else return <Login />;\r\n            }}\r\n          </Route>\r\n          <Route exact path=\"/register\">\r\n            <Register />\r\n          </Route>\r\n          <Route path=\"/:unknown\">\r\n            {({ match }) => {\r\n              return <strong>{`${match.params.unknown} Not Found!`}</strong>;\r\n            }}\r\n          </Route>\r\n        </Switch>\r\n      </BrowserRouter>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default connect(mapStateToProps)(App);\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { createStore } from 'redux';\r\nimport { Provider } from 'react-redux';\r\nimport rootReducer from './reducers'\r\nimport { loadState, saveState } from './localState';\r\nimport throttle from 'lodash/throttle';\r\nimport App from './components/App';\r\nimport 'semantic-ui-css/semantic.min.css';\r\n// import { register } from './push';\r\n\r\nconst persistedState = loadState();\r\nconst store = createStore(rootReducer, persistedState);\r\nstore.subscribe(throttle(() => {\r\n  saveState({\r\n    user: store.getState().user\r\n  })\r\n}, 1000));\r\n\r\n\r\nReactDOM.render(\r\n  // <React.StrictMode>\r\n  <Provider store={store}>\r\n    <App />\r\n  </Provider>,\r\n  // </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\n// serviceWorker.unregister();\r\n","import { localStateName } from './config';\r\n\r\nexport const loadState = () => {\r\n  try {\r\n    const serializedState = localStorage.getItem(`${localStateName}-state`);\r\n    if(serializedState === null) return undefined;\r\n    const expirationTime = parseInt(localStorage.getItem(`${localStateName}-expiration`));\r\n    if(!isNaN(expirationTime) && Date.now() < expirationTime) return JSON.parse(serializedState);\r\n    else {\r\n      localStorage.removeItem(`${localStateName}-state`);\r\n      localStorage.removeItem(`${localStateName}-expiration`);\r\n      return undefined;\r\n    }\r\n  } catch(err) {\r\n    console.error(err);\r\n    return undefined;\r\n  }\r\n};\r\n\r\nexport const saveState = (state) => {\r\n  try {\r\n    const serializedState = JSON.stringify(state);\r\n    localStorage.setItem(`${localStateName}-state`, serializedState);\r\n    const bestBefore = Date.now() + 24*60*60*1000; // one day\r\n    localStorage.setItem(`${localStateName}-expiration`, bestBefore.toString());\r\n  } catch(err) {\r\n    console.error(err);\r\n  }\r\n};"],"sourceRoot":""}